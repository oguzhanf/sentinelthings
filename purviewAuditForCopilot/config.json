{
    "metadata": {
        "version": "1.0.0",
        "description": "Configuration file for Microsoft 365 Copilot Audit Log Ingestion Solution",
        "lastUpdated": "2024-01-01",
        "author": "Security Team"
    },
    "azure": {
        "subscriptionId": "your-subscription-id",
        "resourceGroupName": "rg-sentinel-copilot",
        "location": "East US",
        "tenantId": "your-tenant-id"
    },
    "logAnalytics": {
        "workspaceName": "law-sentinel",
        "workspaceId": "your-workspace-guid",
        "customTableName": "copilotauditlogs_cl",
        "retentionDays": 365,
        "plan": "Analytics"
    },
    "logicApp": {
        "name": "copilot-audit-ingestion",
        "state": "Enabled",
        "trigger": {
            "frequency": "Hour",
            "interval": 1,
            "timeZone": "UTC"
        },
        "managedIdentity": {
            "enabled": true,
            "type": "SystemAssigned"
        }
    },
    "office365ManagementApi": {
        "baseUrl": "https://manage.office.com/api/v1.0",
        "contentType": "Audit.Copilot",
        "requiredPermissions": [
            "ActivityFeed.Read",
            "ActivityFeed.ReadDlp",
            "ServiceHealth.Read"
        ]
    },
    "dataIngestion": {
        "batchSize": 100,
        "maxRetries": 3,
        "retryDelaySeconds": 30,
        "timeoutSeconds": 300
    },
    "monitoring": {
        "enableDiagnostics": true,
        "logLevel": "Information",
        "alerting": {
            "enabled": true,
            "failureThreshold": 3,
            "notificationEmail": "security-team@contoso.com"
        }
    },
    "security": {
        "rbacRoles": [
            {
                "role": "Log Analytics Contributor",
                "scope": "workspace"
            }
        ],
        "apiPermissions": [
            {
                "api": "Office 365 Management APIs",
                "permissions": [
                    "ActivityFeed.Read",
                    "ActivityFeed.ReadDlp",
                    "ServiceHealth.Read"
                ]
            }
        ]
    },
    "deployment": {
        "mode": "Incremental",
        "validateOnly": false,
        "skipTableCreation": false,
        "skipAuthentication": false,
        "enableTesting": true
    },
    "customization": {
        "dataTransformation": {
            "enabled": true,
            "includeAdditionalProperties": true,
            "filterEmptyFields": true
        },
        "fieldMapping": {
            "timeGeneratedField": "TimeGenerated",
            "userIdField": "UserId",
            "activityTypeField": "ActivityType"
        }
    }
}
